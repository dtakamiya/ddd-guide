## 6. インフラストラクチャ層の実装

インフラストラクチャ層は、外部システムとの連携とデータの永続化を担当します。この章では、Google Cloud SpannerとRabbitMQを使用した、クラウドネイティブなインフラストラクチャ層の実装について学びます。

### 6.1. インフラストラクチャ層の役割と設計原則

#### 6.1.1. インフラストラクチャ層の位置づけ

インフラストラクチャ層は、オニオンアーキテクチャの最外層として以下の役割を担います：

**1. データアクセス層**
*   リポジトリパターンの実装
*   データベースとの連携
*   クエリの最適化

**2. 外部システム連携**
*   メッセージングシステム
*   外部APIクライアント
*   ファイルシステム

**3. 技術的関心事の抽象化**
*   データベース固有の実装の隠蔽
*   外部システムの詳細の隠蔽
*   設定と環境の管理

#### 6.1.2. クラウドネイティブ設計の原則

**1. 疎結合**
*   外部システムへの直接依存を避ける
*   インターフェースによる抽象化
*   依存性注入の活用

**2. 耐障害性**
*   リトライ機能の実装
*   サーキットブレーカーパターン
*   フォールバック機能

**3. スケーラビリティ**
*   水平スケーリングへの対応
*   非同期処理の活用
*   キャッシュ戦略 