# 04 ドメイン層

この章では、ドメイン駆動設計（DDD）の戦術的パターンを使用して、ビジネスロジックの中核となるドメイン層を実装します。

## 📋 章の構成

### 4.1 🎯 ドメイン層の概要と設計原則
- [04_domain_overview.md](04_domain_overview.md)
  - ドメインモデリングの実践的アプローチ
  - ユビキタス言語の確立
  - 境界づけられたコンテキストの識別
  - ドメイン層の責任と境界

### 4.2 🔢 値オブジェクト（Value Objects）
- [04_value_object.md](04_value_object.md)
  - Java 17 record型を使用した値オブジェクトの実装
  - 不変性と値による等価性の保証
  - 自己完結した検証ロジック
  - ドメインルールのカプセル化

### 4.3 🆔 エンティティ（Entities）
- [04_entity.md](04_entity.md)
  - 識別子による同一性の管理
  - ファクトリメソッドによる安全な作成
  - ドメインイベントの発行
  - ライフサイクル管理

### 4.4 📦 集約（Aggregates）
- [04_aggregate.md](04_aggregate.md)
  - 一貫性の境界の明確化
  - 外部からのアクセス制御
  - 適切なサイズの決定
  - 集約ルートの設計

### 4.5 🔧 ドメインサービス（Domain Services）
- [04_domain_service.md](04_domain_service.md)
  - 複数の集約にまたがるロジック
  - 副作用のない設計
  - ドメイン層での配置
  - ビジネスルールの実装

### 4.6 🗄️ リポジトリインターフェース
- [04_repository.md](04_repository.md)
  - 集約単位での操作
  - ドメイン層でのインターフェース定義
  - インフラストラクチャ層での実装
  - クエリの抽象化

### 4.7 📢 ドメインイベント
- [04_domain_event.md](04_domain_event.md)
  - 過去形での命名規則
  - 不変オブジェクトとしての実装
  - 発生時刻の管理
  - イベント駆動設計

### 4.8 🏭 ファクトリパターン
- [04_factory.md](04_factory.md)
  - 複雑なオブジェクト生成のカプセル化
  - 不整合な状態の防止
  - 生成ロジックの再利用
  - ドメインルールの適用

### 4.9 🧪 ドメイン層のテスト
- [04_domain_test.md](04_domain_test.md)
  - ドメインロジックの検証
  - ビジネスルールの確認
  - 境界条件のテスト
  - ドメインイベントのテスト

## 🎯 学習のポイント

### 1. **ドメインの深い理解**
- ビジネスルールの正確な把握と制約条件の明確化
- ユビキタス言語の一貫した使用
- ドメインエキスパートとの協働

### 2. **シンプルさの追求**
- 過度に複雑なモデルを避け、実際のビジネスニーズに基づく設計
- YAGNI（You Aren't Gonna Need It）原則の適用
- 必要最小限の抽象化

### 3. **一貫性の維持**
- ユビキタス言語の一貫した使用と設計パターンの統一
- 命名規則の統一
- アーキテクチャ原則の遵守

### 4. **テストの重要性**
- ドメインロジックの検証とビジネスルールの確認
- テスト駆動開発による品質保証
- リファクタリングの安全性確保

## 📚 実装例

この章では、ECサイトの注文管理システムを例として、以下のドメインオブジェクトを実装します：

- **値オブジェクト**: `Email`, `Money`, `OrderId`
- **エンティティ**: `User`, `Product`, `Order`
- **集約**: `Order`（注文集約）
- **ドメインサービス**: `OrderCalculationService`
- **リポジトリ**: `UserRepository`, `OrderRepository`
- **ドメインイベント**: `OrderCreatedEvent`, `OrderCancelledEvent`

## 🔄 次のステップ

次の章では、これらのドメインオブジェクトを活用してアプリケーション層を実装していきます。アプリケーション層では、ドメインオブジェクトを組み合わせてユースケースを実現します。 